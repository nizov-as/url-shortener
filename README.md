
# ‚úÇÔ∏è URL Shortener API

–ü—Ä–æ—Å—Ç–æ–π –∏ —É–¥–æ–±–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫, —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π, —Å—Ä–æ–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏—è –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.  
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **FastAPI**, **PostgreSQL**, **Redis**, **Docker**, **Pydantic v2** –∏ –¥—Ä—É–≥–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- üîó –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (`POST /links/shorten`)
- üß≠ –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–º—É –∫–æ–¥—É (`GET /links/{short_code}`)
- ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ (`PUT /links/{short_code}`)
- ‚ùå –£–¥–∞–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ (`DELETE /links/{short_code}`)
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Å—ã–ª–∫–µ (`GET /links/{short_code}/stats`)
- üîç –ü–æ–∏—Å–∫ –ø–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É URL (`GET /links/search?original_url=...`)
- üß© –ü–æ–¥–¥–µ—Ä–∂–∫–∞ custom alias –∏ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è (`expires_at`)
- üë§ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üîê –ó–∞—â–∏—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Å—ã–ª–∫–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤)
- ‚ö° –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ Redis
- üîÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫
- ‚è≥ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∏—Å—Ç–µ–∫—à–∏—Ö —Å—Å—ã–ª–æ–∫

---

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–≤–æ–∏–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JWT (access token) —á–µ—Ä–µ–∑ `Authorization: Bearer <token>`

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/nizov-as/url-shortener.git
cd url-shortener
```

---

### 2. –°–æ–∑–¥–∞–π `.env` —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î, –∫–ª—é—á–∏ –∏ —Ç.–ø.)

---

### 3. –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Docker

```bash
docker-compose up --build
```

üìå Swagger UI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
http://localhost:8000/docs

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

**–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏:**

```http
POST /links/shorten
Content-Type: application/json

{
  "original_url": "https://example.com",
  "custom_alias": "myalias",
  "expires_at": "2025-04-01T12:00"
}
```

**–†–µ–¥–∏—Ä–µ–∫—Ç:**

```http
GET /links/myalias ‚Üí 307 Redirect ‚Üí https://example.com
```

**–£–¥–∞–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏:**

```http
DELETE /links/myalias
Authorization: Bearer <token>
```

---

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env.example`)

```env
DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/dbname
SYNC_DATABASE_URL=postgresql://user:password@localhost:5432/dbname
REDIS_URL=redis://localhost:6379

SECRET_KEY=your-secret-key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
CLEANUP_THRESHOLD_DAYS=30
```

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü–∞ users**
- `id`, `email`, `hashed_password`, `created_at`

**–¢–∞–±–ª–∏—Ü–∞ links**
- `id`, `original_url`, `short_code`, `custom_alias`, `expires_at`, `click_count`, `last_clicked`, `user_id`, `created_at`

---

## üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- üîÅ **–£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫**  
  –£–¥–∞–ª—è—é—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –±–æ–ª–µ–µ `N` –¥–Ω–µ–π (`CLEANUP_THRESHOLD_DAYS`)

- ‚è≥ **–ò—Å—Ç–æ—Ä–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö —Å—Å—ã–ª–æ–∫**  
  `GET /links/expired` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Å—Å—ã–ª–∫–∏, —á–µ–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∏—Å—Ç—ë–∫

---

## üåê –î–µ–º–æ

üü° *–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Render –∑–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Ä–∞–±–æ—á–∞—è —Å—Å—ã–ª–∫–∞*

---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

Created by [nizov-as](https://github.com/nizov-as)
