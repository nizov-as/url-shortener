
# ‚úÇÔ∏è URL Shortener API

–ü—Ä–æ—Å—Ç–æ–π –∏ —É–¥–æ–±–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫, —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π, —Å—Ä–æ–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏—è –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.  
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **FastAPI**, **PostgreSQL**, **Redis**, **Docker**, **Pydantic v2** –∏ –¥—Ä—É–≥–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- üîó –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (`POST /links/shorten`)
- üß≠ –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–º—É –∫–æ–¥—É (`GET /links/{short_code}`)
- ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ (`PUT /links/{short_code}`)
- ‚ùå –£–¥–∞–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ (`DELETE /links/{short_code}`)
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Å—ã–ª–∫–µ (`GET /links/{short_code}/stats`)
- üîç –ü–æ–∏—Å–∫ –ø–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É URL (`GET /links/search?original_url=...`)
- üß© –ü–æ–¥–¥–µ—Ä–∂–∫–∞ custom alias –∏ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è (`expires_at`)
- üë§ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üîê –ó–∞—â–∏—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Å—ã–ª–∫–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤)
- ‚ö° –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ Redis
- üîÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫
- ‚è≥ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∏—Å—Ç–µ–∫—à–∏—Ö —Å—Å—ã–ª–æ–∫

---

## üîê –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–≤–æ–∏–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
- –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `POST /auth/register`
- –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–∂–∞—Ç—å –Ω–∞ Autorize –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ Swagger –∏ –≤–≤–µ—Å—Ç–∏ username –∏ password –≤ –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è –æ–∫–Ω–µ

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/nizov-as/url-shortener.git
cd url-shortener
```

---

### 2. –°–æ–∑–¥–∞–π `.env` —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î, –∫–ª—é—á–∏ –∏ —Ç.–ø.)

–ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏–π:
```bash
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/url_shortener
SYNC_DATABASE_URL=postgresql://postgres:postgres@db:5432/url_shortener
REDIS_URL=redis://redis:6379
SECRET_KEY=supersecretkey
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
CLEANUP_THRESHOLD_DAYS=30
```

---

### 3. –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Docker

```bash
docker-compose up --build
```

üìå Swagger UI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
http://localhost:8000/docs

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

**–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏:**

```http
POST /links/shorten
Content-Type: application/json

{
  "original_url": "https://example.com",
  "custom_alias": "myalias",
  "expires_at": "2025-04-01T12:00"
}
```

**–†–µ–¥–∏—Ä–µ–∫—Ç:**

```http
GET /links/myalias ‚Üí 307 Redirect ‚Üí https://example.com
```

**Redis –∫—ç—à:**

–†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ myalias –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ (–∏–¥—ë—Ç —á–µ—Ä–µ–∑ Redis)

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü–∞ users**
- `id`, `email`, `hashed_password`, `created_at`

**–¢–∞–±–ª–∏—Ü–∞ links**
- `id`, `original_url`, `short_code`, `custom_alias`, `expires_at`, `click_count`, `last_clicked`, `user_id`, `created_at`

---

## üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- üîÅ **–£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫**  
  –£–¥–∞–ª—è—é—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –±–æ–ª–µ–µ `N` –¥–Ω–µ–π (`CLEANUP_THRESHOLD_DAYS`)

- ‚è≥ **–ò—Å—Ç–æ—Ä–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö —Å—Å—ã–ª–æ–∫**  
  `GET /links/expired` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Å—Å—ã–ª–∫–∏, —á–µ–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∏—Å—Ç—ë–∫

---

## üåê –î–µ–º–æ

üü° [–°—Å—ã–ª–∫–∞ –Ω–∞ –î–µ–º–æ –≤ Render](https://url-shortener-yl7x.onrender.com/docs)

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–§—Ä–µ–π–º–≤–æ—Ä–∫: `pytest` —Å `pytest-asyncio`  
–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–∞ —á–µ—Ä–µ–∑ `docker-compose`.

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
docker-compose -f docker-compose.test.yml up --build

---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

Created by [nizov-as](https://github.com/nizov-as)
